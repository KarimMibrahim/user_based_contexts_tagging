2020-06-08 12:34:33.657596: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2020-06-08 12:34:33.778124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:b1:00.0
totalMemory: 10.92GiB freeMemory: 9.91GiB
2020-06-08 12:34:33.778159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2020-06-08 12:34:34.172619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-08 12:34:34.172662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2020-06-08 12:34:34.172669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2020-06-08 12:34:34.172761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3353 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:b1:00.0, compute capability: 6.1)
/opt/conda/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From single_label_embed_deeper_normalized.py:575: calling argmax (from tensorflow.python.ops.math_ops) with dimension is deprecated and will be removed in a future version.
Instructions for updating:
Use the `axis` argument instead
WARNING:tensorflow:From single_label_embed_deeper_normalized.py:587: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

2020-06-08 12:34:36.048988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2020-06-08 12:34:36.049040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-06-08 12:34:36.049046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2020-06-08 12:34:36.049051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2020-06-08 12:34:36.049129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3353 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:b1:00.0, compute capability: 6.1)
single_label_embed_deeper_normalized.py:154: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
  labels = global_labels[global_labels.song_id == song_id][global_labels.user_id == user_id]
Current Experiment: single_label_audio_layers_user_layers



Execute the following in a terminal:
tensorboard --logdir=/srv/workspace/research/extra_experiment_results/single_label_audio_layers_user_layers/2020-06-08_12-34-35
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #1 Loss: 23.7661 My_loss: 0.0000 accuracy: 0.8297
validation Loss : 21.4404 validation accuracy: 0.8438
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #2 Loss: 21.7910 My_loss: 0.0000 accuracy: 0.8394
validation Loss : 21.0736 validation accuracy: 0.8457
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #3 Loss: 21.2255 My_loss: 0.0000 accuracy: 0.8450
validation Loss : 20.6876 validation accuracy: 0.8490
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #4 Loss: 20.8399 My_loss: 0.0000 accuracy: 0.8485
validation Loss : 20.6544 validation accuracy: 0.8526
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #5 Loss: 20.5003 My_loss: 0.0000 accuracy: 0.8515
validation Loss : 27.3338 validation accuracy: 0.8268
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #6 Loss: 20.1469 My_loss: 0.0000 accuracy: 0.8540
validation Loss : 20.8244 validation accuracy: 0.8498
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #7 Loss: 19.8288 My_loss: 0.0000 accuracy: 0.8565
validation Loss : 21.3238 validation accuracy: 0.8480
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #8 Loss: 19.4981 My_loss: 0.0000 accuracy: 0.8588
validation Loss : 20.4174 validation accuracy: 0.8511
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #9 Loss: 19.1907 My_loss: 0.0000 accuracy: 0.8608
validation Loss : 21.6670 validation accuracy: 0.8449
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #10 Loss: 18.9356 My_loss: 0.0000 accuracy: 0.8623
validation Loss : 20.6735 validation accuracy: 0.8529
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #11 Loss: 18.7084 My_loss: 0.0000 accuracy: 0.8639
validation Loss : 20.7833 validation accuracy: 0.8529
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #12 Loss: 18.3857 My_loss: 0.0000 accuracy: 0.8662
validation Loss : 21.3933 validation accuracy: 0.8485
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #13 Loss: 18.0714 My_loss: 0.0000 accuracy: 0.8683
validation Loss : 20.9988 validation accuracy: 0.8515
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #14 Loss: 17.8270 My_loss: 0.0000 accuracy: 0.8698
validation Loss : 21.2978 validation accuracy: 0.8494
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #15 Loss: 17.5848 My_loss: 0.0000 accuracy: 0.8712
validation Loss : 27.2502 validation accuracy: 0.8217
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #16 Loss: 17.2743 My_loss: 0.0000 accuracy: 0.8737
validation Loss : 25.9322 validation accuracy: 0.8344
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #17 Loss: 17.0321 My_loss: 0.0000 accuracy: 0.8756
validation Loss : 21.7444 validation accuracy: 0.8508
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #18 Loss: 16.7043 My_loss: 0.0000 accuracy: 0.8776
validation Loss : 27.0725 validation accuracy: 0.8376
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #19 Loss: 16.4550 My_loss: 0.0000 accuracy: 0.8794
validation Loss : 22.1584 validation accuracy: 0.8512
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #20 Loss: 16.1943 My_loss: 0.0000 accuracy: 0.8814
validation Loss : 25.5394 validation accuracy: 0.8431
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #21 Loss: 15.9308 My_loss: 0.0000 accuracy: 0.8831
validation Loss : 22.4115 validation accuracy: 0.8491
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #22 Loss: 15.7846 My_loss: 0.0000 accuracy: 0.8843
validation Loss : 23.4961 validation accuracy: 0.8454
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #23 Loss: 15.5428 My_loss: 0.0000 accuracy: 0.8852
validation Loss : 22.8343 validation accuracy: 0.8503
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #24 Loss: 15.3863 My_loss: 0.0000 accuracy: 0.8864
validation Loss : 25.1281 validation accuracy: 0.8398
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #25 Loss: 15.1464 My_loss: 0.0000 accuracy: 0.8879
validation Loss : 27.1920 validation accuracy: 0.8398
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #26 Loss: 14.9077 My_loss: 0.0000 accuracy: 0.8894
validation Loss : 23.4015 validation accuracy: 0.8492
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #27 Loss: 14.7755 My_loss: 0.0000 accuracy: 0.8908
validation Loss : 33.5496 validation accuracy: 0.8338
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #28 Loss: 14.4916 My_loss: 0.0000 accuracy: 0.8932
validation Loss : 25.7241 validation accuracy: 0.8446
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
Epoch #29 Loss: 14.3168 My_loss: 0.0000 accuracy: 0.8938
validation Loss : 28.7604 validation accuracy: 0.8384
No improvement found in a last 10 epochs, stopping optimization.
Last iteration model saved in path: /srv/workspace/research/extra_experiment_results/single_label_audio_layers_user_layers/2020-06-08_12-34-35/last_epoch.ckpt
Model with best validation restored before testing.
Exact match accuracy is: 25.504694835680752%
Macro Area Under the Curve (AUC) is: 0.7166964942773195
saving prediction to disk
